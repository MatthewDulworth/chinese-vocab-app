(this["webpackJsonpvocab-app"]=this["webpackJsonpvocab-app"]||[]).push([[0],{27:function(e,n,t){},28:function(e,n,t){},41:function(e,n,t){"use strict";t.r(n);var a=t(4),c=t.n(a),i=t(22),r=t.n(i),l=(t(27),t(16)),s=t(8),o=t(5),u=(t(28),t(11)),d=t(7),h=(t(29),t(32),t(13)),j=t.n(h),f=(t(37),t(1));d.a.apps.length?d.a.app():d.a.initializeApp({apiKey:"AIzaSyDIefnuJTzI4sUlFuNoRepOM6GDMsPdHTU",authDomain:"vocabapp-3741c.firebaseapp.com",databaseURL:"https://vocabapp-3741c-default-rtdb.firebaseio.com",projectId:"vocabapp-3741c",storageBucket:"vocabapp-3741c.appspot.com",messagingSenderId:"194089023131",appId:"1:194089023131:web:5d5f74308d24971c9bf83e"});var b=d.a.database(),p=b.ref("/vocab");function v(e){var n=e.signIn,t=e.signOut,c=e.signedIn,i=e.handleSearch,r=e.validFluencies,l=e.validPOS,s=Object(a.useState)(!1),u=Object(o.a)(s,2),d=u[0],h=u[1];return Object(f.jsxs)("div",{id:"MainMenu",children:[Object(f.jsx)(g,{handleSearch:i,validFluencies:r,validPOS:l}),!c&&!d&&Object(f.jsx)("button",{onClick:function(){return h(!0)},children:"Sign In"}),c&&Object(f.jsx)("button",{onClick:t,children:"Sign Out"}),d&&Object(f.jsx)(O,{signIn:function(e,t){n(e,t),h(!1)},handleCloseSignIn:function(){return h(!1)}})]})}function O(e){var n=e.signIn,t=e.handleCloseSignIn,c=Object(a.useState)(""),i=Object(o.a)(c,2),r=i[0],l=i[1],s=Object(a.useState)(""),u=Object(o.a)(s,2),d=u[0],h=u[1];return Object(f.jsxs)("div",{id:"SignInDialouge",children:[Object(f.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(f.jsx)("input",{id:"email",type:"email",value:d,onChange:function(e){return h(e.target.value)}}),Object(f.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(f.jsx)("input",{id:"password",type:"password",value:r,onChange:function(e){return l(e.target.value)}}),Object(f.jsx)("button",{onClick:function(e){return n(d,r)},children:"Sign In"}),Object(f.jsx)("button",{onClick:t,children:"Cancel"})]})}function g(e){var n=e.handleSearch,t=e.validFluencies,c=e.validPOS,i=Object(a.useState)(""),r=Object(o.a)(i,2),l=r[0],s=r[1],u=Object(a.useState)("english"),d=Object(o.a)(u,2),h=d[0],j=d[1],b=Object(a.useState)("any"),p=Object(o.a)(b,2),v=p[0],O=p[1],g=Object(a.useState)("any"),x=Object(o.a)(g,2),y=x[0],S=x[1],m=c?Array.from(c).map((function(e){return Object(f.jsx)("option",{value:e,children:E(e)},e)})):"",C=t?Array.from(t).map((function(e){return Object(f.jsx)("option",{value:e,children:E(e)},e)})):"";return Object(f.jsxs)("div",{id:"SearchBar",children:[Object(f.jsx)("div",{children:"Search"}),Object(f.jsxs)("form",{children:["Search Language:",Object(f.jsxs)("select",{value:h,onChange:function(e){return j(e.target.value)},children:[Object(f.jsx)("option",{value:"simplified",children:"\u4e2d\u6587 (Simplified)"}),Object(f.jsx)("option",{value:"traditional",children:"\u4e2d\u6587 (Traditional)"}),Object(f.jsx)("option",{value:"pinyin",children:"\u62fc\u97f3"}),Object(f.jsx)("option",{value:"english",children:"English"})]}),"Part of Speech:",Object(f.jsxs)("select",{value:y,onChange:function(e){return S(e.target.value)},children:[Object(f.jsx)("option",{value:"any",children:"Any"}),m]}),"Fluency Level:",Object(f.jsxs)("select",{value:v,onChange:function(e){return O(e.target.value)},children:[Object(f.jsx)("option",{value:"any",children:"Any"}),C]}),Object(f.jsx)("input",{type:"text",value:l,onChange:function(e){return s(e.target.value)}}),Object(f.jsx)("button",{onClick:function(e){return n(e,l,h,y,v)},children:"Go!"})]})]})}function x(){return Object(f.jsxs)("header",{id:"VocabHeader",children:[Object(f.jsx)("div",{children:"Simplified"}),Object(f.jsx)("div",{children:"Traditional"}),Object(f.jsx)("div",{children:"Pinyin"}),Object(f.jsx)("div",{id:"english",children:"English"}),Object(f.jsx)("div",{children:"Parts of Speech"}),Object(f.jsx)("div",{children:"Fluency"}),Object(f.jsx)("div",{id:"notes",children:"Grammar"}),Object(f.jsx)("div",{id:"entryBtns"})]})}function y(e){var n=e.notes,t=e.handleNotesInputDone,c=Object(a.useState)(n),i=Object(o.a)(c,2),r=i[0],l=i[1],s=Object(a.useRef)(null);return Object(a.useEffect)((function(){s.current.focus(),s.current.setSelectionRange(s.current.value.length,s.current.value.length)}),[]),Object(f.jsx)("div",{className:"NotesInput",children:Object(f.jsxs)("div",{children:[Object(f.jsx)("textarea",{rows:"10",cols:"50",value:r,onChange:function(e){return l(e.target.value)},ref:s}),Object(f.jsx)("button",{onClick:function(e){return t(e,r)},children:"Done"})]})})}function S(e){var n=e.simplified,t=e.traditional,c=e.pinyin,i=(e.english,e.englishString),r=(e.partsOfSpeech,e.posString),l=e.fluency,d=e.notes,h=e._key,j=e.canEdit,b=e.handleChange,p=e.handleEntryChineseUnfocus,v=e.handleNotesInputDone,O=e.validFluencies,g=Object(a.useState)(!1),x=Object(o.a)(g,2),S=x[0],m=x[1],C=Array.from(O).map((function(e){return Object(f.jsx)("option",{value:e,children:E(e)},e)})),w={wrap:"soft",onChange:b,disabled:!j,className:"vocabCell"};return Object(f.jsxs)("div",{className:"VocabEntry",children:[Object(f.jsx)(u.a,Object(s.a)({name:"simplified",value:n,onBlur:function(e){return p(e,h)}},w)),Object(f.jsx)(u.a,Object(s.a)({name:"traditional",value:t,onBlur:function(e){return p(e,h)}},w)),Object(f.jsx)(u.a,Object(s.a)({name:"pinyin",value:c},w)),Object(f.jsx)(u.a,Object(s.a)({name:"englishString",value:i,spellCheck:"true"},w)),Object(f.jsx)(u.a,Object(s.a)({name:"posString",value:r,spellCheck:"true"},w)),Object(f.jsx)("select",{name:"fluency",onChange:b,value:l,className:"vocabCell",disabled:!j,children:C}),Object(f.jsx)("input",{name:"notes",type:"text",value:d,className:"vocabCell",onClick:function(){return m(!0)},readOnly:!0,disabled:!j}),S&&j&&Object(f.jsx)(y,{notes:d,handleNotesInputDone:function(e,n){v(e,h,n),m(!1)}})]})}function m(e){var n=e.vocabEntry,t=e._key,a=e.canEdit,c=e.handleCellChange,i=e.handleEntryChineseUnfocus,r=e.handleEntryDelete,l=e.handleEntrySaveChanges,o=e.handleEntryDiscardChanges,u=e.handleNotesInputDone,d=e.validFluencies,h=e.edited;return Object(f.jsxs)("form",{className:"VocabEntryWrapper",spellCheck:"false",children:[Object(f.jsx)(S,Object(s.a)(Object(s.a)({},n),{},{_key:t,canEdit:a,handleChange:function(e){return c(e,t)},handleEntryChineseUnfocus:i,handleNotesInputDone:u,validFluencies:d})),Object(f.jsxs)("div",{className:"entryBtns",children:[Object(f.jsx)("button",{onClick:function(e){return l(e,t)},disabled:!a||h,children:Object(f.jsx)("i",{className:"fa fa-save"})}),Object(f.jsx)("button",{onClick:function(e){return o(e,t)},disabled:!a||h,children:Object(f.jsx)("i",{className:"fa fa-undo"})}),Object(f.jsx)("button",{onClick:function(e){return r(e,t)},disabled:!a,children:Object(f.jsx)("i",{className:"fa fa-trash"})})]})]})}function C(e){var n=e.vocabList,t=e.editedVocab,a=e.canEdit,c=e.handleCellChange,i=e.handleEntryChineseUnfocus,r=e.handleEntryDelete,l=e.handleEntrySaveChanges,s=e.handleEntryDiscardChanges,u=e.handleNotesInputDone,d=e.validFluencies,h=Array.from(n).map((function(e){var n=Object(o.a)(e,2),h=n[0],j=n[1];return Object(f.jsx)(m,{vocabEntry:j,_key:h,canEdit:a,handleCellChange:c,handleEntryChineseUnfocus:i,handleEntryDelete:r,handleEntrySaveChanges:l,handleEntryDiscardChanges:s,handleNotesInputDone:u,validFluencies:d,edited:!t.has(h)},h)}));return Object(f.jsxs)("section",{id:"VocabTable",children:[Object(f.jsx)(x,{}),h]})}var E=function(e){return e.replace(/([A-Z])/g,(function(e){return" ".concat(e)})).replace(/^./,(function(e){return e.toUpperCase()})).trim()},w=function(e){var n=Object(a.useState)(null),t=Object(o.a)(n,2),c=t[0],i=t[1],r=b.ref(e);return Object(a.useEffect)((function(){var e=r.on("value",(function(e){var n=new Set;e.forEach((function(e){n.add(e.key)})),i(n)}),(function(e){console.log("%cThe read failed: "+e,"color: red;")}));return function(){return p.off("value",e)}}),[]),c},D=function(e){var n=new Map;return e.forEach((function(e,t){return n.set(t,I(e))})),n},I=function(e){var n={};for(var t in e){var a=e[t];Array.isArray(a)?n[t]=Object(l.a)(a):n[t]=a}return n},k=function(e,n){return Object.keys(e).filter(n).reduce((function(n,t){return n[t]=e[t],n}),{})},N=function(e){return j.a.convertToPinyinString(e,"",j.a.WITH_TONE_MARK)},M=function(){var e=Object(a.useState)(new Map),n=Object(o.a)(e,2),t=n[0],c=n[1],i=Object(a.useRef)(new Map),r=Object(a.useState)(new Set),s=Object(o.a)(r,2),u=s[0],h=s[1],b=Object(a.useRef)(!0),O=w("/validFluencies"),g=w("/validPOS"),x=Object(a.useState)(!1),y=Object(o.a)(x,2),S=y[0],m=y[1];return Object(a.useEffect)((function(){var e=p.on("value",(function(e){var n=new Map;e.forEach((function(e){n.set(e.key,e.val());var t=n.get(e.key);t.englishString=t.english.join(", "),t.posString=t.partsOfSpeech.join(", ")})),i.current=n,b.current&&(c(D(n)),b.current=!1),console.log("%cfetching db","color: yellow;")}),(function(e){console.error("failed fetch: "+e)}));return function(){return p.off("value",e)}}),[]),Object(a.useEffect)((function(){d.a.auth().onAuthStateChanged((function(e){e?(console.log("signed in"),m(!0)):(console.log("signed out"),m(!1))}))}),[]),Object(f.jsxs)("div",{id:"App",children:[Object(f.jsx)(v,{signIn:function(e,n){d.a.auth().signInWithEmailAndPassword(e,n).catch((function(e){console.log(e.code),console.log(e.message)}))},signOut:function(){window.confirm("Unsaved changes will be discarded.")&&(u.forEach((function(e){t.set(e,I(i.current.get(e))),c(new Map(t))})),d.a.auth().signOut().catch((function(e){return console.log(e)})))},signedIn:S,handleSearch:function(e,n,t,a,r){e.preventDefault();var l=new Map,s="any"===r,o="any"===a,u=""===n,d="english"!==t?function(e){return e[t].includes(n)}:function(e){return e.english.reduce((function(e,t){return e||t.includes(n)}),!1)};i.current.forEach((function(e,n){!s&&e.fluency!==r||!o&&!e.partsOfSpeech.includes(a)||!u&&!d(e)||l.set(n,I(e))})),c(l)},validFluencies:O,validPOS:g}),Object(f.jsx)(C,{vocabList:t,editedVocab:u,canEdit:S,handleCellChange:function(e,n){e.preventDefault();var a=new Map(t);a.get(n)[e.target.name]=e.target.value,h(new Set(u).add(n)),c(a)},handleEntryChineseUnfocus:function(e,n){e.preventDefault();var a=t.get(n),i=!1;""===a.pinyin&&(a.pinyin=N(a[e.target.name]),i=!0),"simplified"===e.target.name&&""===a.traditional?(a.traditional=j.a.convertToTraditionalChinese(a.simplified),i=!0):"traditional"===e.target.name&&""===a.simplified&&(a.simplified=j.a.convertToSimplifiedChinese(a.traditional),i=!0),i&&c(new Map(t))},handleEntryDelete:function(e,n){e.preventDefault(),window.confirm("Delete Entry?")&&(console.log("confirmed"),p.child(n).remove((function(e){return e?console.error(""+e):console.log("deleted entry")})),t.delete(n),c(new Map(t)))},handleEntrySaveChanges:function(e,n){e.preventDefault();var a=t.get(n);if(a.english=a.englishString.replace(/[\r\n\v]+/g,"").split(",").map((function(e){return e.trim()})),a.partsOfSpeech=a.posString.replace(/[\r\n\v]+/g,"").split(",").map((function(e){return e.trim()})),c(new Map(t)),!a.partsOfSpeech.reduce((function(e,n){return e&&g.has(n)})))return console.log("invalid part of speech"),a.partsOfSpeech=Object(l.a)(i.current.get(n).partsOfSpeech),void c(new Map(t));p.child(n).update(k(a,(function(e){return"englishString"!==e&&"posString"!==e})),(function(e){e?console.error("failed update: "+e):console.log("successful update")}));var r=new Set(u);r.delete(n),h(r)},handleEntryDiscardChanges:function(e,n){e.preventDefault(),c(new Map(t.set(n,I(i.current.get(n)))));var a=new Set(u);a.delete(n),h(a)},handleNotesInputDone:function(e,n,a){t.get(n).notes=a,h(new Set(u).add(n)),c(new Map(t))},validFluencies:O}),S&&Object(f.jsx)("button",{onClick:function(e){e.preventDefault();var n={simplified:"",traditional:"",pinyin:"",english:"",partsOfSpeech:[""],fluency:"fluent",notes:""},a=p.push(n,(function(e){return e?console.error(""+e):console.log("successful add")})).key;n.englishString="",n.posString="",c(new Map(t).set(a,n))},children:"Add Vocab"})]})};r.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(M,{})}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.f57ef354.chunk.js.map